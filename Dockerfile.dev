# Build-only Dockerfile for development
# Usage: docker build -t image-build:1.0.0 -f Dockerfile.dev .
# This image contains build tools and is used to build the project
# Build artifacts are output to mounted ./build directory on host

FROM ubuntu:22.04

WORKDIR /src

# Install build tools and dependencies via apt-get
RUN apt-get update && \
    apt-get install -y \
    build-essential \
    cmake \
    git \
    pkg-config \
    libpqxx-dev \
    libcurl4-openssl-dev \
    nlohmann-json3-dev \
    libssl-dev \
    && rm -rf /var/lib/apt/lists/*

# Default command: build the project
# This will be overridden when running the container
CMD ["bash", "-c", "cmake -S . -B build -DCMAKE_BUILD_TYPE=Release && cmake --build build --parallel $(nproc)"]

